# US-004: User Can Retrieve Personal Photos

| Status | IN PROGRESS |

## Description
As a player of the CBTC Media Day I want to retrieve the file associated with my DNI/Nombre when clicking on "Enviar" button so that I can see my photos.

## Acceptance Criteria

```gherkin
Scenario: User retrieves associated file
  Given the Content Service is deployed
  And there is a file "photo1.jpg" in the S3 bucket with key "TestUser/photo1.jpg"
  And there is a DynamoDB entry for username "TestUser" with photos list "['TestUser/photo1.jpg']"
  When I send a GET request to the content endpoint with Authorization header "12345678A/TestUser"
  Then the response status code should be 200
  And the response body should contain a zip file with the content of "photo1.jpg"
```

```gherkin
Scenario: No photos associated
  Given the Content Service is deployed
  And there is NO DynamoDB entry for username "NoPhotoUser"
  When I send a GET request to the content endpoint with Authorization header "87654321B/NoPhotoUser"
  Then the response status code should be 404
  And the response body should contain "No photos associated to this player"
```

## Related functional tests
- [tests/functional/us_004_test.py](../../tests/functional/us_004_test.py)

## Technical Implementation Details
- **Authorization**: The DNI/Nombre pair is sent in the `Authorization` header.
- **Data Retrieval**:
    - The service uses the Authorization header value as the `username` to query the DynamoDB table.
    - The `photos` attribute in DynamoDB contains a list of S3 keys.
    - The service retrieves the S3 object corresponding to the *first* key in the list (`key1`).
- **Response**:
    - Success: Returns the S3 object content.
    - Failure (No match/No file): Returns 404 with error message "No photos associated to this player".
